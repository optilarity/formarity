import*as e from"@wordpress/interactivity";var t={d:(e,a)=>{for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const a=(s={getConfig:()=>e.getConfig,getContext:()=>e.getContext,getElement:()=>e.getElement,store:()=>e.store},r={},t.d(r,s),r),n={bouncer:{disableSubmit:!0,customValidations:{valueMismatch(e){const t=e.getAttribute("data-bouncer-match");if(!t)return!1;const a=e.form.querySelector("[name="+t+"]");return!!a&&a.value!==e.value}},messageCustom:"data-bouncer-message",messages:{valueMismatch:e=>e.getAttribute("data-bouncer-mismatch-message")||"Please make sure the fields match."}},tinyMce:{selector:"textarea.formello-advanced",setup:e=>{e.on("change",(()=>{window.tinymce.triggerSave()}))},menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"formatselect | bold italic underline | bullist numlist  | alignleft aligncenter alignright alignjustify | link unlink | undo redo",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"}},{state:o}=(0,a.store)("formello",{state:{get message(){const e=(0,a.getContext)();return e.response?.data?.errors?e.response?.data?.message:e.successMessage.length?e.successMessage:e.response?.data?.message},get errors(){const e=(0,a.getContext)();return e.response?.data?.errors||[]}},actions:{validateCaptcha:e=>{const{ref:t}=(0,a.getElement)();if(e.preventDefault(),!t.closest("form").checkValidity())return t.closest("form").requestSubmit(t),!1;(0,a.getContext)().isLoading=!0,(async()=>{const e=(0,a.getConfig)(),t=(0,a.getContext)();if(t.captchaEnabled&&"reCaptcha"===t.captchaType&&"invisible"===e.settings.reCaptcha.version)return window.grecaptcha.execute();t.captchaEnabled&&"hCaptcha"===t.captchaType&&await window.hcaptcha.execute({async:!0})})().then((()=>{t.closest("form").requestSubmit(t)}))},sendForm:e=>{e.preventDefault(),e.stopPropagation();const{ref:t}=(0,a.getElement)(),n=(0,a.getContext)();if(n.enableJsValidation&&!t.checkValidity()){const e=t.querySelector("input:invalid, select:invalid");return e?.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}),void e?.focus()}n.isLoading=!0,(async()=>{const{ref:e}=(0,a.getElement)(),t=(0,a.getContext)(),n=(0,a.getConfig)(),{id:s}=e.dataset,r=new FormData(e);r.append("action","formello"),r.append("_formello",n.nonce),r.append("_formello_id",s);try{t.isLoading=!0;const a=await fetch(n.ajax_url,{method:"POST",body:r}),s=await a.json();t.response=s,t.isLoading=!1,((e,t,a)=>{const{data:n}=t;if(n.redirect_url&&t.success)return window.location=n.redirect_url,!1;if(n.hide&&t.success){const t=e.querySelector(".wp-block-formello-message");e.insertAdjacentElement("beforebegin",t),setTimeout((()=>{e.style.display="none",t.scrollIntoView({behavior:"smooth"})}),"300")}n.debug&&(console.info(n.debug),a.debugData=JSON.stringify(t.data.debug,void 0,2)),t.success&&e.reset()})(e,s,o)}catch(e){t.isLoading=!1,t.response="string"==typeof e||e instanceof String?{data:{message:e},success:!1}:{data:{message:"An error occurred"},success:!1}}})()},setOutput:()=>{const{ref:e}=(0,a.getElement)();"OUTPUT"===e.nextElementSibling?.nodeName&&(e.nextElementSibling.value=e.value)},validateInput:()=>{(0,a.getContext)().enableJsValidation&&(()=>{const{ref:e}=(0,a.getElement)(),t=(0,a.getContext)(),{settings:n}=(0,a.getConfig)();if(t.error="","tel"===e.type&&e.classList.contains("formello-advanced")&&!window.intlTelInput.getInstance(e).isValidNumber()&&e.value)window.intlTelInput.getInstance(e).getValidationError(),e.setCustomValidity("Please match the number format."),t.error=e.validationMessage;else if("tel"===e.type&&e.classList.contains("formello-advanced")){const t=window.intlTelInput?.getInstance(e).getNumber();document.querySelector('input[name="'+e.name+'_full"]').setAttribute("value",t),e.setCustomValidity("")}else e.setCustomValidity("");if("checkbox"===e.type&&e.getAttribute("name").includes("[]")){const t=e.closest(".wp-block-formello-multichoices").querySelector("input[type=checkbox]:checked"),a=e.closest(".wp-block-formello-multichoices").querySelectorAll("input[type=checkbox]:not(:checked)");t?a.forEach((e=>{e.required=!1})):e.closest(".wp-block-formello-multichoices").querySelectorAll("input[type=checkbox]").forEach((e=>{e.required=!0}))}var o,s;e.validity.rangeOverflow&&"time"===e.type&&(t.error=n.messages.outOfRange.over.replace("{max}",e.getAttribute("max").replace("{max}",e.value.max))),e.validity.rangeUnderflow&&"time"===e.type&&(t.error=n.messages.outOfRange.under.replace("{min}",e.getAttribute("min").replace("{min}",e.value.min))),e.validity.tooShort&&(t.error=n.messages.wrongLength.under.replace("{minLength}",e.getAttribute("minlength").replace("{length}",e.value.length))),e.validity.tooLong&&(t.error=n.messages.wrongLength.over.replace("{maxLength}",e.getAttribute("maxlength").replace("{length}",e.value.length))),(e.validity.typeMismatch||e.validity.badInput)&&(t.error=n.messages.patternMismatch[e.type]),e.validity.patternMismatch&&(t.error=null!==(o=null!==(s=n.messages.patternMismatch[e.type])&&void 0!==s?s:e.getAttribute("data-bouncer-message"))&&void 0!==o?o:n.messages.patternMismatch.default),e.validity.valueMissing&&(t.error=n.messages.missingValue.hasOwnProperty(e.type)?n.messages.missingValue[e.type]:n.messages.missingValue.default)})()}},callbacks:{showDebug:()=>{const{ref:e}=(0,a.getElement)();o.debugData&&(window.renderjson.set_show_to_level(2),e.innerHTML="",e.appendChild(window.renderjson(JSON.parse(o.debugData))))},init:()=>{const e=(0,a.getContext)(),t=(0,a.getConfig)();e.messages={...n.bouncer.messages,...t.settings.messages},window.tinymce?.init(n.tinyMce),document.querySelectorAll("input.formello-advanced[type=text]").forEach((e=>{const{flatpickr:t}=e.dataset;window.flatpickr?.(e,JSON.parse(t))})),document.querySelectorAll('input[type="tel"].formello-advanced').forEach((e=>{window.intlTelInput?.(e,{loadUtilsOnInit:"https://cdn.jsdelivr.net/npm/intl-tel-input@24.6.0/build/js/utils.js",hiddenInput:e=>({phone:e+"_full",country:e+"_country_code"}),initialCountry:"auto",geoIpLookup:e=>{fetch("https://ipapi.co/json").then((e=>e.json())).then((t=>e(t.country_code))).catch((()=>e("us")))}})})),document.querySelectorAll("select.formello-advanced").forEach((e=>{new window.TomSelect(e,{create:!0,sortField:{field:"text",direction:"asc"}})})),document.addEventListener("formello:update",(e=>{const{formId:t,data:a}=e.detail;a&&document.querySelectorAll("form.wp-block-formello-form").forEach((e=>{t&&e.dataset.id!==t||Object.entries(a).forEach((([t,a])=>{e.querySelectorAll(`[name="${t}"], [name="${t}[]"]`).forEach((e=>{"radio"===e.type||"checkbox"===e.type?Array.isArray(a)?e.checked=a.includes(e.value):e.checked=e.value==a:e.value=a})),e.querySelectorAll(`[data-formello-bind="${t}"], .formello-bind-${t}`).forEach((e=>{"IMG"===e.tagName?e.src=a:e.textContent=a}))}))}))}))}}});var s,r;